{
  "hash": "da6731ec04e65596704c1b71995849c1",
  "result": {
    "engine": "knitr",
    "markdown": "# Example Model 1: One censored predictor\n\n\n\n\n\n\nFor our first example model, we will consider an example where we have a single\ncensored predictor. Other than censoring, we assume the predictor is measured\nwithout error. We also assume a non-censored perfectly observed outcome,\nwhich follows a Gaussian linear model where the only predictor is that\ncensored one. (We could add additional non-censored predictors but it would\njust make this example more complicated.) The data generating process for the\noutcome, $y_i, \\ i = \\{1, 2, \\ldots, n\\}$ is\n$$\n\\begin{align*}\ny_i &\\sim \\mathrm{Normal}\\left(\\mu, \\sigma^2\\right) \\\\\n\\mu &= \\beta_0 + \\beta_1 x_i^*\n\\end{align*}\n$$\nwhere $x_i^*$ is the latent, true value of the predictor $x$. However, because\nof some imperfect measurement process, we can't observed $x_i^*$, instead we\nobserve\n$$\nx_i = \\begin{cases}\nx_{\\min}, & x_i^* \\leq x_{\\min} \\\\\nx_i^*, & x_i^* > x_{\\min}\n\\end{cases}.\n$$\nSo if we want to correctly model $y$, we will need to take the left censoring\nof $x$ into account.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlod <- 0\ngenerate_data <- function(n = 1000, xmin = 2, beta0 = 1, beta1 = 2, sigma = 5,\n\t\t\t\t\t\t\t\t\t\t\t\t\tseed = 83719273) {\n\tl <- tibble::tibble(\n\t\tx_star = rnorm(n, 5, 3),\n\t\tx = ifelse(x_star <= xmin, xmin, x_star),\n\t\tmu = beta0 + beta1 * x_star,\n\t\ty = rnorm(n, mu, sigma)\n\t)\n\t\n\to <- dplyr::select(l, x, y)\n\t\n\tout <- list(\"latent\" = l, \"observed\" = o)\n}\n\ndat <- generate_data(xmin = lod)\ndat_l <- dat$latent\ndat_o <- dat$observed\n```\n:::\n\n\nWe can take a quick look at the data to see what the relationship looks\nlike when x is censored or not.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat_l |>\n\tggplot() +\n\tgeom_vline(xintercept = lod, linetype = \"dashed\", color = \"gray\") +\n\tgeom_line(\n\t\taes(x = x_star, y = 1 + 2 * x_star), color = \"red\", linetype = \"dashed\",\n\t\tlinewidth = 1\n\t) +\n\tgeom_point(aes(x = x_star, y = y), color = \"gray\", size = 2) +\n\tgeom_point(aes(x = x, y = y), color = \"black\", size = 2) +\n\tlabs(x = \"x\", y = \"y\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nHere the gray points show the true latent values of the censored points, and\nthe black points show what we actually observed. The red line is the true\nregression line from the data generating process.\n\nFor a Bayesian model, before we can fit anything to the data we need to choose\nsuitable priors.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_stan <-\n\tdat_o |>\n\tdplyr::mutate(\n\t\tcens = factor(x <= lod, levels = c(FALSE, TRUE), labels = c('obs', 'cens'))\n\t) |>\n\t# Arrange by whether or not the data is censored. Getting the right format\n\t# for Stan is kind of annoying.\n\tdplyr::arrange(cens)\n\ndat_stan <- list()\ndat_stan$y <- df_stan$y\ndat_stan$x_obs <- subset(df_stan, cens == 'obs')$x\ndat_stan$N <- length(dat_stan$y)\ndat_stan$N_obs <- length(dat_stan$x_obs)\ndat_stan$N_cens <- dat_stan$N - dat_stan$N_obs\ndat_stan$DL <- lod\n```\n:::\n\n\nLoad and compile the stan program\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(cmdstanr)\nmod_pth <- here::here(pth_base, 'Ex1.stan')\nmod <- cmdstanr::cmdstan_model(stan_file = mod_pth)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfit <- mod$sample(dat_stan, seed = 100, parallel_chains = 4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRunning MCMC with 4 parallel chains...\n\nChain 1 Iteration:    1 / 2000 [  0%]  (Warmup) \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nChain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nChain 1 Exception: normal_lpdf: Location parameter[959] is -inf, but must be finite! (in 'C:/Users/Zane/AppData/Local/Temp/Rtmp2ZX9B1/model-4cfc64664ead.stan', line 68, column 1 to column 19)\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nChain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nChain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nChain 1 \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nChain 2 Iteration:    1 / 2000 [  0%]  (Warmup) \nChain 3 Iteration:    1 / 2000 [  0%]  (Warmup) \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nChain 3 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nChain 3 Exception: normal_lpdf: Location parameter[957] is -inf, but must be finite! (in 'C:/Users/Zane/AppData/Local/Temp/Rtmp2ZX9B1/model-4cfc64664ead.stan', line 68, column 1 to column 19)\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nChain 3 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nChain 3 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nChain 3 \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nChain 4 Iteration:    1 / 2000 [  0%]  (Warmup) \nChain 1 Iteration:  100 / 2000 [  5%]  (Warmup) \nChain 2 Iteration:  100 / 2000 [  5%]  (Warmup) \nChain 1 Iteration:  200 / 2000 [ 10%]  (Warmup) \nChain 2 Iteration:  200 / 2000 [ 10%]  (Warmup) \nChain 3 Iteration:  100 / 2000 [  5%]  (Warmup) \nChain 1 Iteration:  300 / 2000 [ 15%]  (Warmup) \nChain 1 Iteration:  400 / 2000 [ 20%]  (Warmup) \nChain 2 Iteration:  300 / 2000 [ 15%]  (Warmup) \nChain 3 Iteration:  200 / 2000 [ 10%]  (Warmup) \nChain 4 Iteration:  100 / 2000 [  5%]  (Warmup) \nChain 1 Iteration:  500 / 2000 [ 25%]  (Warmup) \nChain 1 Iteration:  600 / 2000 [ 30%]  (Warmup) \nChain 2 Iteration:  400 / 2000 [ 20%]  (Warmup) \nChain 2 Iteration:  500 / 2000 [ 25%]  (Warmup) \nChain 3 Iteration:  300 / 2000 [ 15%]  (Warmup) \nChain 3 Iteration:  400 / 2000 [ 20%]  (Warmup) \nChain 4 Iteration:  200 / 2000 [ 10%]  (Warmup) \nChain 4 Iteration:  300 / 2000 [ 15%]  (Warmup) \nChain 1 Iteration:  700 / 2000 [ 35%]  (Warmup) \nChain 1 Iteration:  800 / 2000 [ 40%]  (Warmup) \nChain 2 Iteration:  600 / 2000 [ 30%]  (Warmup) \nChain 2 Iteration:  700 / 2000 [ 35%]  (Warmup) \nChain 3 Iteration:  500 / 2000 [ 25%]  (Warmup) \nChain 3 Iteration:  600 / 2000 [ 30%]  (Warmup) \nChain 4 Iteration:  400 / 2000 [ 20%]  (Warmup) \nChain 4 Iteration:  500 / 2000 [ 25%]  (Warmup) \nChain 1 Iteration:  900 / 2000 [ 45%]  (Warmup) \nChain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) \nChain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) \nChain 2 Iteration:  800 / 2000 [ 40%]  (Warmup) \nChain 2 Iteration:  900 / 2000 [ 45%]  (Warmup) \nChain 3 Iteration:  700 / 2000 [ 35%]  (Warmup) \nChain 3 Iteration:  800 / 2000 [ 40%]  (Warmup) \nChain 4 Iteration:  600 / 2000 [ 30%]  (Warmup) \nChain 1 Iteration: 1100 / 2000 [ 55%]  (Sampling) \nChain 1 Iteration: 1200 / 2000 [ 60%]  (Sampling) \nChain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) \nChain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) \nChain 2 Iteration: 1100 / 2000 [ 55%]  (Sampling) \nChain 2 Iteration: 1200 / 2000 [ 60%]  (Sampling) \nChain 3 Iteration:  900 / 2000 [ 45%]  (Warmup) \nChain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup) \nChain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling) \nChain 4 Iteration:  700 / 2000 [ 35%]  (Warmup) \nChain 4 Iteration:  800 / 2000 [ 40%]  (Warmup) \nChain 4 Iteration:  900 / 2000 [ 45%]  (Warmup) \nChain 1 Iteration: 1300 / 2000 [ 65%]  (Sampling) \nChain 2 Iteration: 1300 / 2000 [ 65%]  (Sampling) \nChain 2 Iteration: 1400 / 2000 [ 70%]  (Sampling) \nChain 3 Iteration: 1100 / 2000 [ 55%]  (Sampling) \nChain 3 Iteration: 1200 / 2000 [ 60%]  (Sampling) \nChain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup) \nChain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling) \nChain 1 Iteration: 1400 / 2000 [ 70%]  (Sampling) \nChain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling) \nChain 2 Iteration: 1500 / 2000 [ 75%]  (Sampling) \nChain 2 Iteration: 1600 / 2000 [ 80%]  (Sampling) \nChain 3 Iteration: 1300 / 2000 [ 65%]  (Sampling) \nChain 3 Iteration: 1400 / 2000 [ 70%]  (Sampling) \nChain 4 Iteration: 1100 / 2000 [ 55%]  (Sampling) \nChain 4 Iteration: 1200 / 2000 [ 60%]  (Sampling) \nChain 1 Iteration: 1600 / 2000 [ 80%]  (Sampling) \nChain 1 Iteration: 1700 / 2000 [ 85%]  (Sampling) \nChain 2 Iteration: 1700 / 2000 [ 85%]  (Sampling) \nChain 2 Iteration: 1800 / 2000 [ 90%]  (Sampling) \nChain 3 Iteration: 1500 / 2000 [ 75%]  (Sampling) \nChain 3 Iteration: 1600 / 2000 [ 80%]  (Sampling) \nChain 3 Iteration: 1700 / 2000 [ 85%]  (Sampling) \nChain 4 Iteration: 1300 / 2000 [ 65%]  (Sampling) \nChain 4 Iteration: 1400 / 2000 [ 70%]  (Sampling) \nChain 1 Iteration: 1800 / 2000 [ 90%]  (Sampling) \nChain 2 Iteration: 1900 / 2000 [ 95%]  (Sampling) \nChain 2 Iteration: 2000 / 2000 [100%]  (Sampling) \nChain 3 Iteration: 1800 / 2000 [ 90%]  (Sampling) \nChain 3 Iteration: 1900 / 2000 [ 95%]  (Sampling) \nChain 4 Iteration: 1500 / 2000 [ 75%]  (Sampling) \nChain 4 Iteration: 1600 / 2000 [ 80%]  (Sampling) \nChain 2 finished in 1.7 seconds.\nChain 1 Iteration: 1900 / 2000 [ 95%]  (Sampling) \nChain 1 Iteration: 2000 / 2000 [100%]  (Sampling) \nChain 3 Iteration: 2000 / 2000 [100%]  (Sampling) \nChain 4 Iteration: 1700 / 2000 [ 85%]  (Sampling) \nChain 4 Iteration: 1800 / 2000 [ 90%]  (Sampling) \nChain 4 Iteration: 1900 / 2000 [ 95%]  (Sampling) \nChain 1 finished in 1.8 seconds.\nChain 3 finished in 1.8 seconds.\nChain 4 Iteration: 2000 / 2000 [100%]  (Sampling) \nChain 4 finished in 1.9 seconds.\n\nAll 4 chains finished successfully.\nMean chain execution time: 1.8 seconds.\nTotal execution time: 2.1 seconds.\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfit$summary() |> print(n = Inf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 50 × 10\n   variable        mean    median     sd    mad       q5      q95  rhat ess_bulk\n   <chr>          <dbl>     <dbl>  <dbl>  <dbl>    <dbl>    <dbl> <dbl>    <dbl>\n 1 lp__       -3723.    -3723.    5.87   5.86   -3.73e+3 -3.71e+3  1.00    1285.\n 2 x_cens[1]     -2.31     -2.13  1.49   1.61   -5.00e+0 -2.15e-1  1.00    2014.\n 3 x_cens[2]     -1.37     -1.14  1.07   1.00   -3.43e+0 -1.04e-1  1.00    2489.\n 4 x_cens[3]     -0.774    -0.588 0.687  0.580  -2.13e+0 -4.20e-2  1.00    2851.\n 5 x_cens[4]     -0.866    -0.658 0.755  0.657  -2.37e+0 -4.55e-2  1.00    2880.\n 6 x_cens[5]     -1.49     -1.27  1.10   1.08   -3.59e+0 -1.34e-1  1.00    2618.\n 7 x_cens[6]     -1.11     -0.870 0.948  0.843  -2.99e+0 -6.37e-2  1.00    2978.\n 8 x_cens[7]     -1.02     -0.799 0.867  0.750  -2.73e+0 -6.64e-2  1.00    3555.\n 9 x_cens[8]     -1.78     -1.53  1.28   1.28   -4.21e+0 -1.58e-1  1.00    3164.\n10 x_cens[9]     -1.06     -0.816 0.916  0.806  -2.88e+0 -6.55e-2  1.00    3507.\n11 x_cens[10]    -1.47     -1.22  1.14   1.09   -3.71e+0 -9.90e-2  1.00    2307.\n12 x_cens[11]    -1.98     -1.74  1.32   1.34   -4.41e+0 -2.20e-1  1.00    3222.\n13 x_cens[12]    -1.95     -1.73  1.35   1.40   -4.44e+0 -2.09e-1  1.00    2712.\n14 x_cens[13]    -0.889    -0.672 0.784  0.666  -2.45e+0 -4.88e-2  1.00    2589.\n15 x_cens[14]    -1.93     -1.73  1.34   1.38   -4.42e+0 -1.74e-1  1.00    2242.\n16 x_cens[15]    -0.809    -0.620 0.709  0.597  -2.20e+0 -4.89e-2  1.00    2875.\n17 x_cens[16]    -1.33     -1.09  1.06   1.03   -3.44e+0 -9.40e-2  1.00    2824.\n18 x_cens[17]    -1.47     -1.22  1.13   1.09   -3.64e+0 -1.23e-1  1.00    3191.\n19 x_cens[18]    -0.641    -0.472 0.589  0.467  -1.80e+0 -4.25e-2  1.00    3424.\n20 x_cens[19]    -1.38     -1.14  1.07   1.03   -3.41e+0 -1.19e-1  1.00    2960.\n21 x_cens[20]    -1.26     -1.03  1.01   0.958  -3.20e+0 -8.55e-2  1.00    2874.\n22 x_cens[21]    -0.717    -0.551 0.622  0.524  -1.98e+0 -5.35e-2  1.00    3477.\n23 x_cens[22]    -1.38     -1.16  1.05   0.983  -3.42e+0 -1.12e-1  1.00    2821.\n24 x_cens[23]    -1.11     -0.883 0.929  0.839  -2.99e+0 -6.73e-2  1.00    2463.\n25 x_cens[24]    -1.13     -0.885 0.955  0.862  -2.94e+0 -5.50e-2  1.00    2692.\n26 x_cens[25]    -1.03     -0.808 0.888  0.769  -2.74e+0 -5.84e-2  1.00    2741.\n27 x_cens[26]    -1.52     -1.27  1.16   1.12   -3.78e+0 -1.16e-1  1.00    2781.\n28 x_cens[27]    -0.857    -0.649 0.765  0.653  -2.39e+0 -4.60e-2  1.00    2670.\n29 x_cens[28]    -1.33     -1.07  1.06   0.970  -3.43e+0 -1.08e-1  1.00    2974.\n30 x_cens[29]    -1.08     -0.851 0.898  0.789  -2.85e+0 -8.07e-2  1.00    3813.\n31 x_cens[30]    -1.28     -1.04  0.997  0.915  -3.21e+0 -1.12e-1  1.00    3114.\n32 x_cens[31]    -0.690    -0.516 0.614  0.518  -1.89e+0 -3.73e-2  1.00    3079.\n33 x_cens[32]    -3.49     -3.39  1.80   1.89   -6.64e+0 -7.10e-1  1.00    2547.\n34 x_cens[33]    -0.613    -0.453 0.573  0.448  -1.75e+0 -3.15e-2  1.00    2918.\n35 x_cens[34]    -1.10     -0.878 0.923  0.808  -2.97e+0 -6.91e-2  1.00    2291.\n36 x_cens[35]    -1.08     -0.862 0.907  0.796  -2.86e+0 -7.26e-2  1.00    3204.\n37 x_cens[36]    -0.785    -0.584 0.716  0.591  -2.26e+0 -4.23e-2  1.00    2653.\n38 x_cens[37]    -0.986    -0.758 0.858  0.750  -2.68e+0 -5.32e-2  1.00    2775.\n39 x_cens[38]    -1.22     -0.934 1.05   0.927  -3.34e+0 -7.69e-2  1.00    2905.\n40 x_cens[39]    -1.08     -0.879 0.867  0.810  -2.84e+0 -7.71e-2  1.00    3050.\n41 x_cens[40]    -0.790    -0.600 0.705  0.587  -2.19e+0 -4.83e-2  1.00    3248.\n42 x_cens[41]    -1.58     -1.33  1.21   1.17   -3.92e+0 -1.16e-1  1.00    2396.\n43 x_cens[42]    -1.25     -1.03  0.992  0.932  -3.19e+0 -8.47e-2  1.00    2962.\n44 x_cens[43]    -0.792    -0.565 0.728  0.574  -2.21e+0 -4.47e-2  1.00    3998.\n45 x_cens[44]    -1.07     -0.829 0.899  0.788  -2.80e+0 -7.47e-2  1.00    3359.\n46 a              1.34      1.34  0.306  0.300   8.34e-1  1.85e+0  1.00    1893.\n47 b              1.96      1.96  0.0534 0.0526  1.87e+0  2.04e+0  1.00    2007.\n48 s              5.07      5.06  0.114  0.114   4.89e+0  5.26e+0  1.00    4258.\n49 mu_x           4.92      4.92  0.0946 0.0907  4.76e+0  5.08e+0  1.00    4323.\n50 sigma_x        2.95      2.95  0.0680 0.0673  2.85e+0  3.07e+0  1.00    3939.\n# ℹ 1 more variable: ess_tail <dbl>\n```\n\n\n:::\n:::\n\n\n## The other method (Bjorn method)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod_pth <- here::here(pth_base, 'Ex1b.stan')\nmod2 <- cmdstanr::cmdstan_model(stan_file = mod_pth)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndat2 <- list()\ndat2$y <- df_stan$y\ndat2$x <- df_stan$x\ndat2$x_cens <- df_stan$cens\ndat2$N <- length(dat2$y)\ndat2$DL <- lod\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfit2 <- mod2$sample(dat2, seed = 100, parallel_chains = 4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRunning MCMC with 4 parallel chains...\n\nChain 1 Iteration:    1 / 2000 [  0%]  (Warmup) \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nChain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue:\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nChain 1 Exception: normal_lcdf: Scale parameter is 0, but must be positive! (in 'C:/Users/Zane/AppData/Local/Temp/Rtmpq4W877/model-44107d12126b.stan', line 64, column 3 to column 55)\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nChain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine,\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nChain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nChain 1 \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\nChain 2 Iteration:    1 / 2000 [  0%]  (Warmup) \nChain 3 Iteration:    1 / 2000 [  0%]  (Warmup) \nChain 4 Iteration:    1 / 2000 [  0%]  (Warmup) \nChain 1 Iteration:  100 / 2000 [  5%]  (Warmup) \nChain 3 Iteration:  100 / 2000 [  5%]  (Warmup) \nChain 4 Iteration:  100 / 2000 [  5%]  (Warmup) \nChain 1 Iteration:  200 / 2000 [ 10%]  (Warmup) \nChain 2 Iteration:  100 / 2000 [  5%]  (Warmup) \nChain 3 Iteration:  200 / 2000 [ 10%]  (Warmup) \nChain 1 Iteration:  300 / 2000 [ 15%]  (Warmup) \nChain 3 Iteration:  300 / 2000 [ 15%]  (Warmup) \nChain 4 Iteration:  200 / 2000 [ 10%]  (Warmup) \nChain 2 Iteration:  200 / 2000 [ 10%]  (Warmup) \nChain 1 Iteration:  400 / 2000 [ 20%]  (Warmup) \nChain 3 Iteration:  400 / 2000 [ 20%]  (Warmup) \nChain 4 Iteration:  300 / 2000 [ 15%]  (Warmup) \nChain 2 Iteration:  300 / 2000 [ 15%]  (Warmup) \nChain 1 Iteration:  500 / 2000 [ 25%]  (Warmup) \nChain 3 Iteration:  500 / 2000 [ 25%]  (Warmup) \nChain 4 Iteration:  400 / 2000 [ 20%]  (Warmup) \nChain 2 Iteration:  400 / 2000 [ 20%]  (Warmup) \nChain 1 Iteration:  600 / 2000 [ 30%]  (Warmup) \nChain 3 Iteration:  600 / 2000 [ 30%]  (Warmup) \nChain 4 Iteration:  500 / 2000 [ 25%]  (Warmup) \nChain 2 Iteration:  500 / 2000 [ 25%]  (Warmup) \nChain 1 Iteration:  700 / 2000 [ 35%]  (Warmup) \nChain 3 Iteration:  700 / 2000 [ 35%]  (Warmup) \nChain 4 Iteration:  600 / 2000 [ 30%]  (Warmup) \nChain 2 Iteration:  600 / 2000 [ 30%]  (Warmup) \nChain 1 Iteration:  800 / 2000 [ 40%]  (Warmup) \nChain 3 Iteration:  800 / 2000 [ 40%]  (Warmup) \nChain 4 Iteration:  700 / 2000 [ 35%]  (Warmup) \nChain 2 Iteration:  700 / 2000 [ 35%]  (Warmup) \nChain 1 Iteration:  900 / 2000 [ 45%]  (Warmup) \nChain 3 Iteration:  900 / 2000 [ 45%]  (Warmup) \nChain 2 Iteration:  800 / 2000 [ 40%]  (Warmup) \nChain 4 Iteration:  800 / 2000 [ 40%]  (Warmup) \nChain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) \nChain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup) \nChain 4 Iteration:  900 / 2000 [ 45%]  (Warmup) \nChain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) \nChain 2 Iteration:  900 / 2000 [ 45%]  (Warmup) \nChain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling) \nChain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup) \nChain 1 Iteration: 1100 / 2000 [ 55%]  (Sampling) \nChain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) \nChain 3 Iteration: 1100 / 2000 [ 55%]  (Sampling) \nChain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling) \nChain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) \nChain 2 Iteration: 1100 / 2000 [ 55%]  (Sampling) \nChain 4 Iteration: 1100 / 2000 [ 55%]  (Sampling) \nChain 1 Iteration: 1200 / 2000 [ 60%]  (Sampling) \nChain 3 Iteration: 1200 / 2000 [ 60%]  (Sampling) \nChain 2 Iteration: 1200 / 2000 [ 60%]  (Sampling) \nChain 4 Iteration: 1200 / 2000 [ 60%]  (Sampling) \nChain 1 Iteration: 1300 / 2000 [ 65%]  (Sampling) \nChain 3 Iteration: 1300 / 2000 [ 65%]  (Sampling) \nChain 2 Iteration: 1300 / 2000 [ 65%]  (Sampling) \nChain 4 Iteration: 1300 / 2000 [ 65%]  (Sampling) \nChain 1 Iteration: 1400 / 2000 [ 70%]  (Sampling) \nChain 3 Iteration: 1400 / 2000 [ 70%]  (Sampling) \nChain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling) \nChain 2 Iteration: 1400 / 2000 [ 70%]  (Sampling) \nChain 3 Iteration: 1500 / 2000 [ 75%]  (Sampling) \nChain 4 Iteration: 1400 / 2000 [ 70%]  (Sampling) \nChain 2 Iteration: 1500 / 2000 [ 75%]  (Sampling) \nChain 4 Iteration: 1500 / 2000 [ 75%]  (Sampling) \nChain 1 Iteration: 1600 / 2000 [ 80%]  (Sampling) \nChain 3 Iteration: 1600 / 2000 [ 80%]  (Sampling) \nChain 2 Iteration: 1600 / 2000 [ 80%]  (Sampling) \nChain 4 Iteration: 1600 / 2000 [ 80%]  (Sampling) \nChain 1 Iteration: 1700 / 2000 [ 85%]  (Sampling) \nChain 3 Iteration: 1700 / 2000 [ 85%]  (Sampling) \nChain 2 Iteration: 1700 / 2000 [ 85%]  (Sampling) \nChain 4 Iteration: 1700 / 2000 [ 85%]  (Sampling) \nChain 1 Iteration: 1800 / 2000 [ 90%]  (Sampling) \nChain 3 Iteration: 1800 / 2000 [ 90%]  (Sampling) \nChain 2 Iteration: 1800 / 2000 [ 90%]  (Sampling) \nChain 4 Iteration: 1800 / 2000 [ 90%]  (Sampling) \nChain 1 Iteration: 1900 / 2000 [ 95%]  (Sampling) \nChain 3 Iteration: 1900 / 2000 [ 95%]  (Sampling) \nChain 2 Iteration: 1900 / 2000 [ 95%]  (Sampling) \nChain 1 Iteration: 2000 / 2000 [100%]  (Sampling) \nChain 4 Iteration: 1900 / 2000 [ 95%]  (Sampling) \nChain 3 Iteration: 2000 / 2000 [100%]  (Sampling) \nChain 1 finished in 10.1 seconds.\nChain 3 finished in 10.1 seconds.\nChain 2 Iteration: 2000 / 2000 [100%]  (Sampling) \nChain 2 finished in 10.4 seconds.\nChain 4 Iteration: 2000 / 2000 [100%]  (Sampling) \nChain 4 finished in 10.4 seconds.\n\nAll 4 chains finished successfully.\nMean chain execution time: 10.3 seconds.\nTotal execution time: 10.6 seconds.\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfit2$summary() |>\n\tdplyr::filter(!startsWith(variable, \"x\")) |>\n\tprint(n = Inf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 10\n  variable       mean     median      sd     mad       q5     q95  rhat ess_bulk\n  <chr>         <dbl>      <dbl>   <dbl>   <dbl>    <dbl>   <dbl> <dbl>    <dbl>\n1 lp__     -3142.     -3142.     22.9    22.8    -3.18e+3 -3.10e3  1.00    1284.\n2 a            0.918      0.921   0.333   0.335   3.68e-1  1.46e0  1.00    2693.\n3 b            2.02       2.02    0.0577  0.0576  1.92e+0  2.11e0  1.00    3018.\n4 s            5.12       5.11    0.115   0.113   4.94e+0  5.32e0  1.00    6196.\n5 mu_x        -0.0474    -0.0592 10.2    10.2    -1.66e+1  1.64e1  1.00    5704.\n6 sigma_x      0.503      0.339   0.510   0.348   2.87e-2  1.51e0  1.00    5172.\n# ℹ 1 more variable: ess_tail <dbl>\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npost <- posterior::as_draws_array(fit2)\n```\n:::\n\n\n\n<!-- END OF FILE -->\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}