{
  "hash": "1665f84af66a13987e7d1a25eda2f708",
  "result": {
    "engine": "knitr",
    "markdown": "# What are censored data?\n\nCensoring is a selection phenomenon on data which occurs when we can only\nobtain precise measurements for certain measurement values. The classical\nexample is a scale which can only measure weights up to a certain threshold,\nsay $y_{\\mathrm{max}}$. A scale that can measure any weight would produce the\nset of measurements $\\{y_1^*, y_2^*, \\ldots, y_n^*\\}$ where $n$ is the sample\nsize. We call these the **latent values** or **true values**. Our imperfect\nscale would then produce the **observed values**,\n$$\ny_i = \\begin{cases}\ny_i^*, & y_i^* \\leq y_{\\mathrm{max}} \\\\\ny_{\\mathrm{max}}, & y_i^* > y_{\\mathrm{max}}\n\\end{cases}; \\quad i = 1, \\ldots, n.\n$$\nSpecifically, this is an example of **right censoring**, where there is an\n**upper limit of detection**, or maximum value that we can observe with\nprecision. Right censoring is also incredibly common in epidemiology and\nbiomedical studies: when we conduct an observational study or clinical trial,\nwe expect to observe individuals who have not experienced the outcome of\ninterest before the trial ends. These individuals have a time-to-event with\na lower bound of the length of the trial (the event could have occurred the\nmoment we stopped observing) and an infinite upper bound, because the event\nmay never occur. Such an individual's survival time would be right-censored,\nand many common survival analysis methods can account for right-censored\ndata (assuming an appropriate parametric distribution for the outcome).\n\nWe can also have the opposite case, where we can detect any theoretical\nmeasurement above a certain value. In this case, the data are said to have a\n**lower limit of detection** and this phenomenon is called **left censoring**.\nFor example, imagine we are testing the concentration of lead in the tap water\nof several buildings. Our test cannot detect lead levels below 1 part per\nbillion (ppb), but can detect any larger amount of lead. In that case, our\nobserved values would instead look like this:\n$$\n\\begin{aligned}\ny_i &= \\begin{cases}\ny_i^*, & y_i^* \\geq y_{\\mathrm{min}} \\\\\ny_{\\mathrm{min}}, & y_i^* < y_{\\mathrm{min}}\n\\end{cases};\\\\\ni &= 1, \\ldots, n; \\\\\ny_{\\min} &= 1 \\text{ ppb;}\n\\end{aligned}\n$$\nwhere $y_{\\mathrm{min}}$ is the lower limit of detection. I don't know anything\nabout how lead concentration tests work, but suppose that at a certain point our\ntest \"saturates\": we know that the concentration is at or above, say, 5 parts\nper million (ppm), but the test cannot detect any higher values. Then some of\nour observations would be left-censored (below the lower LOD) and some\nobservations would be right-censored (above the upper LOD). So then the\nlead level data that we observe would look this:\n\n$$\n\\begin{aligned}\ny_i &= \\begin{cases}\ny_{\\mathrm{min}}, & y_i^* < y_{\\mathrm{min}} \\\\\ny_i^*, & y_{\\max} \\geq y_i^* \\geq y_{\\mathrm{min}} \\\\\ny_{\\max}, & y_i^* > y_{\\max}\n\\end{cases};\\\\\ni &= 1, \\ldots, n; \\\\\ny_{\\min} &= 1 \\text{ ppb;} \\\\\ny_{\\max} &= 5 \\text{ ppm;}\n\\end{aligned}\n$$\nNote that for a continuous random variable like (presumably) the level of lead\nin drinking water, it doesn't really matter which categories include the\nboundary values, because $P(Y_i^* = y_i^*) = 0$ for any value of $y_i^*$\nincluding $y_{\\min}$ and $y_{\\max}$. If the censored variable is not absolutely\ncontinuous, then this distinction may need to be clarified and depends on the\nobservation process.\n\nFinally, we can have interval censoring, where we know a data value is within\nsome interval, but we do not know precisely where the value lies within that\ninterval. We could imagine a lead test that looks like this (whether such a\ntest could exist in reality, I am unsure). Suppose that the test involves\ndipping a test strip into water, and the test strip changes color based on the\namount of lead present in the water. However, only a discrete number of\nshades can be visibility distinguished, so even though the underlying variable\nof interest is continuous (again, the lead concentration), we only observe\na discrete set of outcomes. For example, if our outcome can only reliably\ndiscern 6 different concentrations, the data might look like this. The table\nbelow also includes a coding scheme in the \"Data Value\" column showing how\nwe might write down the data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolfunc <- colorRampPalette(c(\"white\", \"firebrick3\"))\nconc <- c(\"<1 ppb\", \"1 ppb - 10 ppb\", \"10 ppb - 100 ppb\", \"100 ppb - 1000 ppb\",\n\t\t\t\t\t\"1000 ppb - 5000 ppb\", \">5000 ppb\")\nvalues <- c(0, 5, 50, 500, 2500, 5000)\ntable_data <-\n\ttibble::tibble(\n\t\t\"Lead Concentration\" = conc,\n\t\t\"Strip Color\" = 1:length(conc),\n\t\t\"Data Value\" = values\n\t)\nlead_table <-\n\ttable_data |>\n\tgt::gt() |>\n\tgt::data_color(\n\t\tcolumns = c(`Strip Color`),\n\t\tpalette = colfunc(length(conc))\n\t) |>\n\tgt::tab_style(\n\t\tstyle = gt::cell_text(color = \"#00000000\"),\n\t\tlocations = gt::cells_body(columns = `Strip Color`)\n\t)\n\nlead_table\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"bbqoskjbmz\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#bbqoskjbmz table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#bbqoskjbmz thead, #bbqoskjbmz tbody, #bbqoskjbmz tfoot, #bbqoskjbmz tr, #bbqoskjbmz td, #bbqoskjbmz th {\n  border-style: none;\n}\n\n#bbqoskjbmz p {\n  margin: 0;\n  padding: 0;\n}\n\n#bbqoskjbmz .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#bbqoskjbmz .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#bbqoskjbmz .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#bbqoskjbmz .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#bbqoskjbmz .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bbqoskjbmz .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bbqoskjbmz .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#bbqoskjbmz .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#bbqoskjbmz .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#bbqoskjbmz .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#bbqoskjbmz .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#bbqoskjbmz .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#bbqoskjbmz .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#bbqoskjbmz .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#bbqoskjbmz .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#bbqoskjbmz .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#bbqoskjbmz .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#bbqoskjbmz .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#bbqoskjbmz .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bbqoskjbmz .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#bbqoskjbmz .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#bbqoskjbmz .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#bbqoskjbmz .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bbqoskjbmz .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#bbqoskjbmz .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#bbqoskjbmz .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bbqoskjbmz .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bbqoskjbmz .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#bbqoskjbmz .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bbqoskjbmz .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#bbqoskjbmz .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#bbqoskjbmz .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bbqoskjbmz .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bbqoskjbmz .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#bbqoskjbmz .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#bbqoskjbmz .gt_left {\n  text-align: left;\n}\n\n#bbqoskjbmz .gt_center {\n  text-align: center;\n}\n\n#bbqoskjbmz .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#bbqoskjbmz .gt_font_normal {\n  font-weight: normal;\n}\n\n#bbqoskjbmz .gt_font_bold {\n  font-weight: bold;\n}\n\n#bbqoskjbmz .gt_font_italic {\n  font-style: italic;\n}\n\n#bbqoskjbmz .gt_super {\n  font-size: 65%;\n}\n\n#bbqoskjbmz .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#bbqoskjbmz .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#bbqoskjbmz .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#bbqoskjbmz .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#bbqoskjbmz .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#bbqoskjbmz .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#bbqoskjbmz .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Lead Concentration\">Lead Concentration</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Strip Color\">Strip Color</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Data Value\">Data Value</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Lead Concentration\" class=\"gt_row gt_left\">&lt;1 ppb</td>\n<td headers=\"Strip Color\" class=\"gt_row gt_right\" style=\"background-color: #FFFFFF; color: rgba(0,0,0,0);\">1</td>\n<td headers=\"Data Value\" class=\"gt_row gt_right\">0</td></tr>\n    <tr><td headers=\"Lead Concentration\" class=\"gt_row gt_left\">1 ppb - 10 ppb</td>\n<td headers=\"Strip Color\" class=\"gt_row gt_right\" style=\"background-color: #F5D3D3; color: rgba(0,0,0,0);\">2</td>\n<td headers=\"Data Value\" class=\"gt_row gt_right\">5</td></tr>\n    <tr><td headers=\"Lead Concentration\" class=\"gt_row gt_left\">10 ppb - 100 ppb</td>\n<td headers=\"Strip Color\" class=\"gt_row gt_right\" style=\"background-color: #EBA8A8; color: rgba(0,0,0,0);\">3</td>\n<td headers=\"Data Value\" class=\"gt_row gt_right\">50</td></tr>\n    <tr><td headers=\"Lead Concentration\" class=\"gt_row gt_left\">100 ppb - 1000 ppb</td>\n<td headers=\"Strip Color\" class=\"gt_row gt_right\" style=\"background-color: #E17C7C; color: rgba(0,0,0,0);\">4</td>\n<td headers=\"Data Value\" class=\"gt_row gt_right\">500</td></tr>\n    <tr><td headers=\"Lead Concentration\" class=\"gt_row gt_left\">1000 ppb - 5000 ppb</td>\n<td headers=\"Strip Color\" class=\"gt_row gt_right\" style=\"background-color: #D75151; color: rgba(0,0,0,0);\">5</td>\n<td headers=\"Data Value\" class=\"gt_row gt_right\">2500</td></tr>\n    <tr><td headers=\"Lead Concentration\" class=\"gt_row gt_left\">&gt;5000 ppb</td>\n<td headers=\"Strip Color\" class=\"gt_row gt_right\" style=\"background-color: #CD2626; color: rgba(0,0,0,0);\">6</td>\n<td headers=\"Data Value\" class=\"gt_row gt_right\">5000</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\nIn general there is not a unique or standardized way to write down interval\ncensored data, and writing down the data model will heavily depend on the\nobservation process and the coding scheme for the values. For this specific\nexample, we could write down the observation model like this:\n\n$$\ny_i = \\begin{cases}\n0, & 1 > y_i^* \\\\\n5, & 10 > y_i^* \\geq 1 \\\\\n50, & 100 > y_i^* \\geq 10 \\\\\n500, & 1000 > y_i^* \\geq 100 \\\\\n2500, & 5000 > y_i^* \\geq 1000 \\\\\n5000, & y_i^* \\geq 5000\n\\end{cases}; \\quad i = 1, \\ldots, n.\n$$\nIt is possible to write the math model in a more compact form as well --- we\nwill discuss this further in a detailed section on interval censoring.\n\nAnother example of this is influenza HAI titer, which we will dedicate an\nentire case study to later on. Briefly,\nthe values are typically reported as 10, 20, 40, etc., but a value of 10 does\nnot mean the precise value of the measurement should be 10, it means the true\nvalue is between 10 and 20. If we assume our titer is measured on the log\nscale and has no limits of detection, we could write\n$$\ny_i = \\lfloor y_i^* \\rfloor; \\quad i = 1, \\ldots, n,\n$$\nbecause we only perform a discrete number of dilutions. This gives us the\ninterval value for $y_i$ as\n$$y_i \\in \\left[\\lfloor y_i^* \\rfloor, \\lfloor y_i^* + 1 \\rfloor\\right).$$\n\nA given variable can be subject to all of these types of censoring simultaneously:\nfor example, HAI titers are interval censored in this way, but they also have\nlower limits of detection and upper limits of detection as well (though the\nupper limits are rarely important in practice because they can be arbitrarily\nincreased during the assay). However, a particular observation of this variable\ncan only be subject to one type of censoring at a time: e.g., if an observation\nis below the detection limit, that value is left censored, it cannot simultaneously\nbe right censored or interval censored.\n\nNotably, the distinction between \"types\" of censoring in this way is useful for\nseveral analytic methods, but is not strictly necessary. All censored values can\nbe implicitly treated as interval censored data, where the lower endpoint for\na left censored value is negative infinity, and the upper endpoint for a\nright censored value is positive infinity. Thus, we could write the data\ngenerating process for HAI titers with LOD as\n$$\ny_i = \\begin{cases}\ny_{l}, & \\ y_i^* < y_{\\text{min}}\\\\\n\\lfloor y_i^* \\rfloor, &\\ y_{\\text{min}} \\leq y_i^* < y_{\\text{max}} \\\\\ny_{i}, & y_i^* \\leq y_{\\text{max}}\n\\end{cases},\n$$\nwhere $y_{\\text{min}}$ is the lower limit of detection and $y_{\\text{max}}$\nis the upper limit of detection. Here, $y_l \\leq y_{\\min}$ and $y_u \\geq y_{\\max}$ are arbitrary constants that can be the same as the limits of detection\nor not, so long as we know which censoring category the given $y_i$ value falls\ninto. We can write down the value for the censored values however we want as\nlong as we know what interval the points fall into.\n\nTo express the DGP in interval\nnotation, we would write\n$$\ny_i \\in \\begin{cases}\n\\left(-\\infty, y_{l}\\right), & y_i^* < y_{\\text{min}}\\\\\n\\left[\\lfloor y_i^* \\rfloor, \\lfloor y_i^* + 1 \\rfloor\\right), & y_{\\text{min}} \\leq y_i^* < y_{\\text{max}} \\\\\n\\left[y_{u}, \\infty\\right), & y_i^* \\leq y_{\\text{max}}\n\\end{cases}.\n$$\nNote also that assuming $y^*_i$ is drawn from an absolutely continuous distribution\n(e.g. normal or lognormal, etc.), the final likelihood model will be equivalent\nregardless of which intervals are open or closed. This model would allow\nus to put all of the censored observations into the likelihood function in the same\nframework without having to worry about sorting the observations into buckets\nw.r.t. the type of censoring.\n\nThe probability of each observation $y_i$ can then be expressed as the\nprobability that the random variable $Y$ takes on a realization inside the\ngiven interval. That is, if $y_i^*$ is detectable (greater than the lower LoD,\nbut less than the upper LoD), we would write\n$$P(Y_i = y_i) = P\\left(\\lfloor y_i^* + 1 \\rfloor \\geq Y_i^* \\geq \\lfloor y_i^* \\rfloor \\right).$$\nRecall that every random variable $Y$ has a [cumulative density function](https://en.wikipedia.org/wiki/Cumulative_distribution_function), or **CDF**, which is defined as\n$$F_Y(y) = P(Y \\leq y).$$\nUsing the definitions of all these probability things, we can say (proof\nomitted) that\n$$\n\\begin{aligned}\nP(Y_i = y_i) &= P\\left(\\lfloor y_i^* + 1 \\rfloor \\geq Y_i^* \\geq \\lfloor y_i^* \\rfloor \\right) \\\\\n&= P(Y_i^* \\leq \\lfloor y_i^* + 1 \\rfloor) - P(Y_i \\leq \\lfloor y_i^* \\rfloor) \\\\\n&= F_Y(\\lfloor y_i^* + 1 \\rfloor) - F_Y(\\lfloor y_i^* \\rfloor).\n\\end{aligned}\n$$\nThis applies to the nondetectable measurements as well, but we need to take\nthe limit as $Y_i \\to \\pm \\infty$.Fortunately, this is a defining property of\nthe CDF as you can see on the linked wikipedia page. So we can write\n$$\n\\begin{aligned}\nP(Y_i = y_\\min) &= \\lim_{a \\to -\\infty}P\\left(y_{\\text{min}} \\geq Y_i^* \\geq a \\right) \\\\\n&= F(y_\\min) - \\lim_{a \\to -\\infty} F(a) \\\\\n&= F(y_\\min) - 0 = F(y_\\min).\n\\end{aligned}\n$$\nSimilarly, we get that\n$$\n\\begin{aligned}\nP(Y_i = y_\\max) &= \\lim_{b \\to \\infty}P\\left(b \\geq Y_i^* \\geq y_\\max \\right) \\\\\n&= \\lim_{b \\to \\infty} F(b) -  F(y_\\max) \\\\\n&= 1 - F(y_\\max).\n\\end{aligned}\n$$\n\nAt first, it can be difficult to see how this probability calculations are\nuseful for statistical data analysis. To fully make the connection, we will\nneed to make use of an indicator variable, say $c_i$, which is equal to 1 when\nthe observation $y_i$ is censored, and equal to 0 if $y_i$ is not censored.\nTo fit some parametric model with parameter vector $\\theta$, we often turn to\nthe likelihood function, which is\n$$\n\\mathcal{L}\\left(\\theta \\mid y \\right) = f_Y(y \\mid \\theta)\n$$\nif there are no censored values (here we implicitly assume that $y$ is\nabsolutely continuous). The function $f_Y(y \\mid \\theta)$ is the [probability\ndensity function](https://en.wikipedia.org/wiki/Probability_density_function) of\nrandom variable $Y$ where we consider the parameters to be fixed at the value\n$\\theta$.\n\nIn constructing the likelihood for our observation $Y_i$, we run into the\nslightly tricky business^[to really get into the details of this, you need [Lebesgue's decomposition theorem](https://en.wikipedia.org/wiki/Lebesgue's_decompositon_theorem) which relies on measure theory. Writing out the likelihood in a more general form without the censoring indicators is also not possible without measure theory because it relies on the [Radon-Nikodym theorem](https://en.wikipedia.org/wiki/Radon%E2%80%93Nikodym_theorem). If this is the part you want to learn about, you will have to learn it from someone other than me!] that $Y_i$ is not always continuous -- if the $i$th\nobservation is censored, $Y_i$ actually becomes discrete. We will not address\nthe technicalities of combining censored and discrete data here, but suffice to\nsay if the parametric model we assume for $Y_i$ is any standard (all GLM\ncompatible distributions and many others beyond), we can say that\n$$\n\\mathcal{L}(\\theta \\mid y_i) = \\bigg( f(y_i \\mid \\theta) \\bigg)^{1 - c_i} \\bigg( P(Y_i = y_i)\\bigg)^{c_i}.\n$$\nThat is, we can use the continuous probability density $f$ when $y_i$ is\nnot censored and the discrete probability of the realization $y_i$ if the\nobservation is censored.\n\nWe can then (assuming mutual, potentially conditional, independence of the observations) write the likelihood of the sample by multiplying together all of\nour individual $y_i$ likelihoods. With the sample likelihood in hand, we can\nproceed to do whatever kinds of torture we would normally do in modern statistics, like finding parameter values that maximize the likelihood, or adding priors and using Bayes' theorem.\n\n**In the following chapters, we'll discuss a bit more theory but primarily go\nthrough some examples.** Notably, we've only discussed univariate analyses here,\nso in the first example we'll walk through an actual example of dealing\nwith a censored outcome variable. Dealing\nwith censored predictor/independent variables is much more detailed, and will\nbe explained in its own example.\n\n<!--\nNow, given that $F$ is the CDF for the parametric distribution which we\nassume the latent variable $y_i^*$ is drawn from, with parameter vector $\\theta$,\nthe contribution of $y_i$ to the likelihood is then\n$$\\mathcal{L}(\\theta \\mid Y_i) = F(\\text{upper limit of interval}) - F(\\text{lower limit of interval}).$$\nIf we call the lower limit of the interval for $y_i$ $L_i$ and the corresponding\nupper limit $U_i$, we can write the likelihood of the sample as\n$$\n\\mathcal{L}(\\theta \\mid \\mathbf{Y}) = \\prod_{i=1}^n \\left(\nF(y_i \\mid \\theta)\\bigg\\rvert_{y_i = L_i}^{U_i}\n\\right)^{C_i}\\bigg(f(y_i\\mid \\theta) \\bigg)^{C_i},\n$$\nwhere $C_i$ is the indicator variable for $y_i$ being censored. Notably, for an uncensored observation the likelihood is equal to the density. However, for the typical\ntypes of HAI data that we see, all of the assay values are subject to the\nsame censoring process, and thus we could neglect the density component.\n\nSo now the remaining issue is to specify $F$, the CDF of the latent variables.\n-->\n\n<!-- END OF FILE -->\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}